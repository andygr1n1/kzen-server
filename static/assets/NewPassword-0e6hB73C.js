import{G as n,H as u,J as m,ap as l,L as i,ab as p,A as w,aq as f,j as o}from"./index-Cx9aHWms.js";import{F as h,a as x,S as y}from"./formik.esm-ADxEa5mi.js";import{I as P}from"./IconInfiniteLoading-BhfJWl73.js";import"./antd-bK47dtYc.js";import{A as c}from"./AuthPasswordInput-e_2fnOLH.js";import{u as g}from"./useMutation-D6aZmw1J.js";import"./react-day-picker-BMg2DGmo.js";import"./cn-Bz47sbbS.js";import"./types-CKSFNBik.js";const j=n.object({restoreCode:n.string().trim().min(1,"Required field").nullable(),password:n.string().trim().min(1,"Required field"),passwordRepeat:n.string().trim().min(1,"Required field")}),S=async r=>{const e="http://localhost:8008/kzen/",t="022569013";try{return await u.post(`${e}new-password`,{credentials:"include",json:r.formData,method:"POST",headers:{"x-api-key":t,"Content-Type":"application/json"}}).json()}catch(s){return await m(s)}},b=()=>{const r=l(),e=g({mutationFn:({formData:s})=>S({formData:s})});return{onSubmit:(s,a)=>{if(!s.restoreCode){i("We don't recognize you. May be your link is broken. Please restart the process. Thank you!"),a.resetForm(),a.setSubmitting(!1);return}e.mutate({formData:s},{onError:d=>{i(d.message)},onSuccess:()=>{a.resetForm(),p(`
                        Account was restored successfully. Thank you!`),r(`/${w.LOGIN}`)},onSettled:()=>{a.setSubmitting(!1)}})}}},N=()=>({validate:e=>{const t=j.safeParse(e),s={};if(!t.success)for(const a of t.error.issues)s[a.path[0]]=a.message;return e.password!==e.passwordRepeat&&(s.password="Passwords do not match",s.passwordRepeat="Passwords do not match"),s}}),R=()=>({initialValues:{password:"",passwordRepeat:"",restoreCode:f()}}),q=()=>{const{onSubmit:r}=b(),{validate:e}=N(),{initialValues:t}=R();return o.jsx("div",{className:"flex flex-col gap-10 mt-10 items-center",children:o.jsx(h,{initialValues:t,validate:e,onSubmit:r,children:({isSubmitting:s})=>o.jsxs(x,{className:"flex flex-col gap-5",children:[o.jsx(c,{}),o.jsx(c,{repeatType:!0}),o.jsx(y,{className:"w-full",type:"submit",disabled:s,startIcon:s&&o.jsx(P,{className:"text-slate-500 w-5 h-5"}),children:"Restore"})]})})})};export{q as default};
//# sourceMappingURL=NewPassword-0e6hB73C.js.map
