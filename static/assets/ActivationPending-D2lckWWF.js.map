{"version":3,"file":"ActivationPending-D2lckWWF.js","sources":["../../src/modules/auth/activation-pending/service/server_resendActivationLink.ts","../../src/modules/auth/activation-pending/hooks/useDebouncedEmailSender.hook.ts","../../src/modules/auth/activation-pending/service/useResendActivationLink.ts","../../src/modules/auth/activation-pending/hooks/usePendingActivation.hook.ts","../../src/modules/auth/activation-pending/ActivationPending.tsx"],"sourcesContent":["import { resolveError } from '@/helpers/tryCatchRequest'\nimport ky from 'ky'\n\nexport const server_resendActivationLink = async (props: { email?: string | null }) => {\n    const endpoint = import.meta.env['VITE_NODE_HEROKU_ORIGIN']\n    const xapikey = import.meta.env['VITE_X_API_KEY']\n\n    try {\n        await ky\n            .post(`${endpoint}register/resend-activation-link`, {\n                credentials: 'include', //\n                json: { email: props.email },\n                headers: {\n                    'x-api-key': xapikey,\n                },\n            })\n            .json<{ status: string }>()\n    } catch (e) {\n        return await resolveError(e)\n    }\n}\n","import { debounce } from 'lodash-es'\nimport { useCallback, useRef } from 'react'\n\nexport const useDebouncedEmailSender = (resendEmail: () => void) => {\n    const isFirstRequest = useRef(true)\n\n    const debouncedSendEmail = useCallback(\n        debounce(() => {\n            resendEmail?.()\n        }, 60000),\n        [resendEmail],\n    )\n\n    const sendEmail = useCallback(() => {\n        if (isFirstRequest.current) {\n            resendEmail?.()\n            isFirstRequest.current = false\n        } else {\n            debouncedSendEmail()\n        }\n    }, [debouncedSendEmail, resendEmail])\n\n    return sendEmail\n}\n","import { useMutation } from '@tanstack/react-query'\n\nimport { processError, notifySuccess } from '@/helpers/processMessage'\nimport { server_resendActivationLink } from './server_resendActivationLink'\nimport { useDebouncedEmailSender } from '../hooks/useDebouncedEmailSender.hook'\n\nexport const useResendActivationLink = (props: { email?: string | null }) => {\n    const { email } = props\n    const mutation = useMutation({\n        mutationFn: ({ email }: { email?: string | null }) => server_resendActivationLink({ email }),\n        onError: () => {\n            processError('Sending activation link failed')\n        },\n        onSuccess: () => {\n            notifySuccess('Email with activation link will appear within a minute')\n        },\n    })\n\n    const resendEmailDebounced = useDebouncedEmailSender(() => {\n        mutation.mutate({ email })\n    })\n\n    return { resendActivationLink: resendEmailDebounced }\n}\n","import { useEffect } from 'react'\nimport { getParam_Email } from '@/helpers/urlSearchParams'\nimport { useNavigate } from 'react-router-dom'\nimport { useResendActivationLink } from '../service/useResendActivationLink'\nimport { useRoot$ } from '@/modules/app/mst/StoreProvider'\n\nexport const usePendingActivation = () => {\n    const navigate = useNavigate()\n    const email = getParam_Email()\n    const { fetchGuestData } = useRoot$()\n    const { resendActivationLink } = useResendActivationLink({ email })\n\n    useEffect(() => {\n        fetchGuestData({ navigate })\n    }, [])\n\n    return { resendActivationLink }\n}\n","import { observer } from 'mobx-react-lite'\nimport { usePendingActivation } from './hooks/usePendingActivation.hook'\nimport { useRoot$ } from '@/modules/app/mst/StoreProvider'\nimport { IconInfiniteLoading } from '@/assets/icons'\n\nconst ActivationPending = observer(() => {\n    const { resendActivationLink } = usePendingActivation()\n    const { user, userIsLoading } = useRoot$()\n\n    if (userIsLoading) return <IconInfiniteLoading className='absolute-center w-10 h-10 text-blue-500 duration-300' />\n\n    return (\n        <div className='px-5 text-sm font-inter'>\n            <p>Registration Successful </p>\n            <p>Dear {user?.name}, Welcome to Kzen!</p>\n            <br />\n            <p>\n                Email with activation link has been sent to\n                <span className='text-blue-500 pl-1'>{user?.email}</span>.\n            </p>\n            <p>\n                To complete your registration and activate your account, please check your inbox and follow the\n                instructions in the email.\n            </p>\n            <p> If you don’t see the email in your inbox, please check your spam or junk folder.</p>\n            <p> If you still haven’t received it, click the button below.</p>\n            <p>\n                <button\n                    type='button'\n                    className='underline p-0 m-0 cursor-pointer underline-offset-4 hover:text-blue-500 duration-300'\n                    onClick={resendActivationLink}\n                >\n                    Resend activation email\n                </button>\n            </p>\n        </div>\n    )\n})\n\nexport default ActivationPending\n"],"names":["server_resendActivationLink","props","endpoint","import","xapikey","ky","post","credentials","json","email","headers","e","resolveError","useDebouncedEmailSender","resendEmail","isFirstRequest","useRef","debouncedSendEmail","useCallback","debounce","sendEmail","current","useResendActivationLink","mutation","useMutation","mutationFn","onError","processError","onSuccess","notifySuccess","resendActivationLink","mutate","usePendingActivation","navigate","useNavigate","getParam_Email","fetchGuestData","useRoot$","useEffect","ActivationPending","observer","user","userIsLoading","jsx","IconInfiniteLoading","jsxs","name"],"mappings":"gUAGaA,MAAAA,EAA8B,MAAOC,GAAqC,CAC7EC,MAAAA,EAAWC,8BACXC,EAAUD,YAEZ,GAAA,CACA,MAAME,EACDC,KAAM,GAAEJ,CAAS,kCAAkC,CAChDK,YAAa,UACbC,KAAM,CAAEC,MAAOR,EAAMQ,KAAM,EAC3BC,QAAS,CACL,YAAaN,CAAAA,CAEpB,CAAA,EACAI,KAAyB,QACzBG,EAAG,CACD,OAAA,MAAMC,EAAaD,CAAC,CAAA,CAEnC,ECjBaE,EAA2BC,GAA4B,CAC1DC,MAAAA,EAAiBC,SAAO,EAAI,EAE5BC,EAAqBC,cACvBC,EAAS,IAAM,CACGL,GAAA,MAAAA,GAAA,EACf,GAAK,EACR,CAACA,CAAW,CAChB,EAWOM,OATWF,EAAAA,YAAY,IAAM,CAC5BH,EAAeM,SACDP,GAAA,MAAAA,IACdC,EAAeM,QAAU,IAENJ,EAAA,CACvB,EACD,CAACA,EAAoBH,CAAW,CAAC,CAGxC,ECjBaQ,EAA2BrB,GAAqC,CACnE,KAAA,CAAEQ,MAAAA,CAAAA,EAAUR,EACZsB,EAAWC,EAAY,CACzBC,WAAYA,CAAC,CAAEhB,MAAAA,KAAuCT,EAA4B,CAAES,MAAAA,CAAAA,CAAO,EAC3FiB,QAASA,IAAM,CACXC,EAAa,gCAAgC,CACjD,EACAC,UAAWA,IAAM,CACbC,EAAc,wDAAwD,CAAA,CAC1E,CACH,EAMM,MAAA,CAAEC,qBAJoBjB,EAAwB,IAAM,CACvDU,EAASQ,OAAO,CAAEtB,MAAAA,CAAAA,CAAO,CAAA,CAC5B,CAEmD,CACxD,ECjBauB,EAAuBA,IAAM,CACtC,MAAMC,EAAWC,EAAY,EACvBzB,EAAQ0B,EAAe,EACvB,CAAEC,eAAAA,GAAmBC,EAAS,EAC9B,CAAEP,qBAAAA,GAAyBR,EAAwB,CAAEb,MAAAA,CAAAA,CAAO,EAElE6B,OAAAA,EAAAA,UAAU,IAAM,CACGF,EAAA,CAAEH,SAAAA,CAAAA,CAAU,CAC/B,EAAG,EAAE,EAEE,CAAEH,qBAAAA,CAAqB,CAClC,ECZMS,EAAoBC,EAAS,IAAM,CAC/B,KAAA,CAAEV,qBAAAA,GAAyBE,EAAqB,EAChD,CAAES,KAAAA,EAAMC,cAAAA,GAAkBL,EAAS,EAEzC,OAAIK,EAAuBC,EAAA,IAAAC,EAAA,CAAoB,UAAU,uDAAyD,EAG9GC,EAAA,KAAC,MAAI,CAAA,UAAU,0BACX,SAAA,CAAAF,EAAAA,IAAC,KAAE,SAAwB,0BAAA,CAAA,SAC1B,IAAE,CAAA,SAAA,CAAA,QAAMF,GAAAA,YAAAA,EAAMK,KAAK,oBAAA,EAAkB,QACrC,KAAE,EAAA,SACF,IAAC,CAAA,SAAA,CAAA,8CAEGH,EAAA,IAAA,OAAA,CAAK,UAAU,qBAAsBF,0BAAMhC,MAAM,EAAO,GAAA,EAC7D,EACAkC,EAAAA,IAAC,KAAC,SAGF,4HAAA,CAAA,EACAA,EAAAA,IAAC,KAAE,SAAiF,mFAAA,CAAA,EACpFA,EAAAA,IAAC,KAAE,SAA0D,4DAAA,CAAA,EAC7DA,EAAA,IAAC,IACG,CAAA,SAAAA,EAAAA,IAAC,SACG,CAAA,KAAK,SACL,UAAU,uFACV,QAASb,EAAqB,SAAA,yBAAA,CAGlC,CACJ,CAAA,CAAA,EACJ,CAER,CAAC"}