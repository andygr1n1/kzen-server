import{u as g,P as m,O as l,J as h,j as o,o as _}from"./index-Cx9aHWms.js";import{X as c}from"./XTooltip-Bdc9vu0b.js";import{S as n}from"./formik.esm-ADxEa5mi.js";import{a as f}from"./IconNew-BhAnMb5r.js";import"./antd-bK47dtYc.js";import{u as p}from"./useMutation-D6aZmw1J.js";import{b as F,a as v}from"./achResponseFr-DHzlt_Pk.js";import{f as w}from"./date.helpers-BWySBUrV.js";import{c as u}from"./cn-Bz47sbbS.js";import{I as x}from"./IconHeart-CwlJhkiG.js";import{j}from"./ProtectedRoutes-BInEfiaw.js";import{u as I}from"./provider-CFg4W0mD.js";const A=()=>{const i=g();return{onSuccess:()=>{i.invalidateQueries({predicate:r=>r.queryKey[0]===F.instance})}}},D=async({id:i,deletedAt:e})=>{const r=m(`
            mutation mutation_updateAchDeletedAt($id: uuid!, $deletedAt: timestamptz) {
                update_achievements_by_pk(pk_columns: { id: $id }, _set: { deleted_at: $deletedAt }) {
                    ...AchResponseFr
                }
            }
        `,[v]),t=await l();try{return await t.request(r,{id:i,deletedAt:e})}catch(a){return await h(a)}},S=()=>{const{onSuccess:i}=A(),e=p({mutationFn:({id:t,deletedAt:a})=>D({id:t,deletedAt:a}),onSuccess:i});return{updateDeletedAt:({id:t,deletedAt:a})=>{e.mutate({id:t,deletedAt:a})}}},Q=({id:i,deletedAt:e,label:r,onClose:t,context:a})=>{const{updateDeletedAt:s}=S();return o.jsxs(o.Fragment,{children:[o.jsx(n,{className:u(a==="drawer"&&"!w-full !py-5"),id:"toggleMoveAchToBin",size:"small",error:!!e,variant:"text",onClick:()=>{s({id:i,deletedAt:e?null:w()}),t==null||t()},startIcon:o.jsx(f,{width:24,height:24,className:"h-6 w-6 opacity-70 hover:opacity-100"}),children:r}),!r&&o.jsx(c,{anchorSelect:"#toggleMoveAchToBin",children:e?"Restore":"Move to bin"})]})},$=async({id:i,isFavorite:e})=>{const r=m(`
            mutation mutation_updateAchIsFavorite($id: uuid!, $isFavorite: Boolean!) {
                update_achievements_by_pk(pk_columns: { id: $id }, _set: { is_favorite: $isFavorite }) {
                    ...AchResponseFr
                }
            }
        `,[v]),t=await l();try{return await t.request(r,{id:i,isFavorite:e})}catch(a){return await h(a)}},k=()=>{const{onSuccess:i}=A(),e=p({mutationFn:({id:t,isFavorite:a})=>$({id:t,isFavorite:a}),onSuccess:i});return{toggleFavorite:({id:t,isFavorite:a})=>{e.mutate({id:t,isFavorite:a})}}},X=({id:i,isFavorite:e,label:r,onClose:t,context:a})=>{const{toggleFavorite:s}=k();return o.jsxs(o.Fragment,{children:[o.jsx(n,{className:u(a==="drawer"&&"!w-full !py-5"),id:"toggleFavoriteAch",error:!!e,variant:e?"contained":"text",size:"small",onClick:()=>{s({id:i,isFavorite:!e}),t==null||t()},startIcon:o.jsx(x,{className:"mb-0.5 h-6 w-6 opacity-70 hover:opacity-100"}),children:r}),!r&&o.jsx(c,{anchorSelect:"#toggleFavoriteAch",children:e?"Unfavorite":"Favorite"})]})},H=_(({label:i,id:e,onClose:r,context:t})=>{const{edit_id:a,readonly:s,onOpenEditMode:d,onOpenViewMode:y}=I();return o.jsxs(o.Fragment,{children:[o.jsx(n,{className:u(t==="drawer"&&"!w-full !py-5 !h-0"),id:"editAch",variant:a&&!s?"contained":"text",size:"custom",startIcon:o.jsx(j,{className:"h-6 w-6 opacity-70 hover:opacity-100"}),onClick:()=>{t==="menu"?d({edit_id:e}):s?d({edit_id:e}):y({edit_id:e}),r==null||r()},children:i}),!i&&o.jsx(c,{anchorSelect:"#editAch",children:a?"Cancel":"Edit"})]})});export{X as A,H as a,Q as b,A as u};
//# sourceMappingURL=AchToggleEdit-D8Nqb8YI.js.map
