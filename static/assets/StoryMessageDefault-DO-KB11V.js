import{j as t,o as c,u as h,b2 as y}from"./index-Cx9aHWms.js";import{X as f,e as v}from"./XTiptap-Ch2jQgok.js";import{H as j,c as S,d,j as M,n as g,k as b,X as w}from"./ProtectedRoutes-BInEfiaw.js";import{u as p,a as I,b as D}from"./StoryMakerIndex-D8sxgPvi.js";import{c as T}from"./index--O-lbexr.js";import{f as X}from"./date.helpers-BWySBUrV.js";import{X as k}from"./XTooltip-Bdc9vu0b.js";import{a as z}from"./StoriesIndex-Dkg1SUFS.js";import"./antd-bK47dtYc.js";import{S as l}from"./formik.esm-ADxEa5mi.js";import{u as C}from"./useDeleteStoryMessage-DB_NrQ5L.js";import{h as F}from"./react-day-picker-BMg2DGmo.js";import"./XSkeleton-x0yqnB_E.js";import"./cn-Bz47sbbS.js";import"./useMatchMedia.hook-CVR6FWmx.js";import"./useMutation-D6aZmw1J.js";import"./IconNew-BhAnMb5r.js";import"./IconSearch-CPJHC6Kt.js";import"./debounce-CqMFxJgi.js";import"./types-8-lvdrKU.js";import"./IconHeart-CwlJhkiG.js";const N=({message:e})=>{var o,a,s,i,r;return(a=(o=e.story)==null?void 0:o.users)!=null&&a.length?t.jsxs(t.Fragment,{children:[t.jsx("div",{id:`storyMessageAvatar-${e.id}`,className:"w-10 opacity-50 duration-300 group-hover:opacity-100 flex absolute -left-14 top-2 h-10 rounded-full shadow-xl items-center justify-center text-base",children:(s=e.updated_by_user)!=null&&s.avatar?t.jsx("img",{"data-testid":"image-avatar",alt:"avatar",src:`https://firebunny-storage.b-cdn.net/kzen//avatars/${(i=e.updated_by_user)==null?void 0:i.avatar}`,className:"w-full h-full rounded-full "}):t.jsx(j,{"data-testid":"icon-avatar",width:20,height:20,className:"text-cText opacity-70 duration-300 "})}),t.jsx(k,{anchorSelect:`#storyMessageAvatar-${e.id}`,children:((r=e.updated_by_user)==null?void 0:r.name)||""})]}):null},_=c(({message:e,onClose:o})=>{const{onChangeField:a,editSelectedMessageId:s}=p(),{deleteStoryMessage:i}=C(),r=e.id===s;return t.jsxs(S,{children:[t.jsx(d,{onClick:()=>{a("editSelectedMessageId",r?void 0:e.id),o()},children:t.jsx(l,{variant:"text",size:"small",startIcon:t.jsx(M,{width:24,height:24}),children:t.jsx("span",{className:"flex w-[110px] justify-start capitalize",children:r?"Save":"Edit"})})}),t.jsx(d,{onClick:()=>{i({id:e.id}),o()},children:t.jsx(l,{variant:"text",size:"small",startIcon:t.jsx(g,{width:24,height:24}),children:t.jsx("span",{className:"flex w-[110px] justify-start capitalize",children:"Delete"})})})]})}),rt=c(({message:e})=>{const o=h(),{popoverState:a,setPopoverState:s}=b(),{onChangeField:i,editSelectedMessageId:r}=p(),{updateStoryMessage:u}=I(),{id:m}=D();if(!e.description)return null;const x=()=>{s(!1)};return t.jsx(w,{open:a,onOpenChange:()=>{s(!a)},trigger:["contextMenu"],dropdownRender:()=>t.jsx(_,{message:e,onClose:x}),children:t.jsxs("div",{className:"relative group px-2 py-4 duration-300 border-b-solid border-transparent hover:border-blue-500/10",children:[t.jsx(N,{message:e}),t.jsx("div",{className:"text-xs opacity-0 duration-300 group-hover:opacity-80 top-0 absolute  font-semibold font-kzen cursor-default text-cText",children:F(X(new Date(e.updated_at)),"dd MMMM yyyy HH:mm")}),t.jsx(f,{onSave:({html:n})=>{if(!v(n).trim().length){y("Type something");return}u({description:n,id:T(e.id),onSuccess:()=>{i("editSelectedMessageId",void 0),o.invalidateQueries({queryKey:z.useFetchStoryMessages(m)})}})},readonly:e.id!==r,content:e.description,customToolbar:e.id===r})]})})});export{rt as default};
//# sourceMappingURL=StoryMessageDefault-DO-KB11V.js.map
