import{j as e,b0 as f,b1 as g,X as h,Y as I}from"./index-Cx9aHWms.js";import{u as d,X as x,a as v,S as b,F}from"./formik.esm-ADxEa5mi.js";import{F as j,y as N,G as S,z as c,A as y,B as C}from"./ProtectedRoutes-BInEfiaw.js";import"./antd-bK47dtYc.js";import"./react-day-picker-BMg2DGmo.js";import"./cn-Bz47sbbS.js";import"./useMatchMedia.hook-CVR6FWmx.js";import"./useMutation-D6aZmw1J.js";const m=({type:t})=>{const s=d();return e.jsxs("div",{children:[e.jsx(j,{title:`${t==="name1"?"First guest name *":"Second guest name"}`}),e.jsx(x,{"data-testid":`guest-name-input-${t}`,autoFocus:t==="name1",value:s.values[t],name:t,onChange:s.handleChange,error:s.touched[t]&&!!s.errors[t],errorMessage:s.errors[t]})]})},l=({type:t})=>{const s=d();return e.jsxs("div",{children:[e.jsx(j,{title:`${t==="surname1"?"First guest surname":"Second guest surname"}`}),e.jsx(x,{"data-testid":`guest-surname-input-${t}`,value:s.values[t],name:t,onChange:s.handleChange,error:s.touched[t]&&!!s.errors[t],errorMessage:s.errors[t]})]})},w=()=>e.jsxs(v,{className:"flex flex-col gap-4 h-full",children:[e.jsxs("div",{className:"flex flex-col gap-4 flex-auto",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(N,{className:"w-10 h-10 text-cText opacity-70"})}),e.jsx(S,{}),e.jsx("div",{className:"flex gap-2 my-2 justify-center",children:e.jsx(c,{className:"w-5 h-5 justify-center text-cText opacity-70"})}),e.jsx(m,{type:"name1"}),e.jsx(l,{type:"surname1"}),e.jsx("div",{className:"flex gap-2 my-2 justify-center",children:e.jsx(c,{className:"w-5 h-5 justify-center text-cText opacity-70"})}),e.jsx(m,{type:"name2"}),e.jsx(l,{type:"surname2"})]}),e.jsx(b,{type:"submit",className:"w-full",size:"large",children:"Create Invitation"})]}),G=()=>{const t=new Uint8Array(5);return crypto.getRandomValues(t),Array.from(t,s=>("0"+(s%36).toString(36)).slice(-1).toUpperCase()).join("")},E=()=>{const[t]=f(),[s]=g();return{createInvitation:async({values:n,onSuccess:o})=>{const a=crypto.randomUUID(),i=G(),p={id:a,name:n.groupName,booking_number:i};await t({object:p});const u=[{group_id:a,first_name:n.name1,last_name:n.surname1,primary:!0}];n.name2&&u.push({group_id:a,first_name:n.name2,last_name:n.surname2,primary:!1}),await s({objects:u}).unwrap().then(()=>o())}}},k=()=>{const t=h(),{createInvitation:s}=E(),r=()=>{t(I({field:"open",value:!1}))};return{onSubmit:(o,a)=>{const{setSubmitting:i}=a;s({values:o,onSuccess:()=>{i(!1),r()}})}}},R=()=>{const{onSubmit:t}=k(),{validate:s}=C(),{initialValues:r}=y();return e.jsx(F,{enableReinitialize:!0,initialValues:r,validate:s,onSubmit:t,children:e.jsx(w,{})})};export{R as default};
//# sourceMappingURL=InvitationEditor-B3AKKvnn.js.map
